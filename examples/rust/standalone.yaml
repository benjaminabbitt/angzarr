# Standalone mode configuration for Rust Poker example
# Run with: cargo run --bin angzarr-standalone --features standalone,sqlite -- --config examples/rust/standalone.yaml

storage:
  type: sqlite

messaging:
  type: channel

transport:
  type: uds
  uds:
    base_path: /tmp/angzarr-poker-rust

standalone:
  aggregates:
    - domain: player
      port: 50001
      command: ["./examples/rust/target/release/agg-player"]
      env:
        RUST_LOG: info
        UDS_BASE_PATH: /tmp/angzarr-poker-rust
        SERVICE_NAME: business
        DOMAIN: player
      storage:
        type: sqlite
        sqlite:
          path: ./examples/rust/data/player.db

    - domain: table
      port: 50002
      command: ["./examples/rust/target/release/agg-table"]
      env:
        RUST_LOG: info
        UDS_BASE_PATH: /tmp/angzarr-poker-rust
        SERVICE_NAME: business
        DOMAIN: table
      storage:
        type: sqlite
        sqlite:
          path: ./examples/rust/data/table.db

    - domain: hand
      port: 50003
      command: ["./examples/rust/target/release/agg-hand"]
      env:
        RUST_LOG: info
        UDS_BASE_PATH: /tmp/angzarr-poker-rust
        SERVICE_NAME: business
        DOMAIN: hand
      storage:
        type: sqlite
        sqlite:
          path: ./examples/rust/data/hand.db

  sagas:
    - name: saga-table-hand
      port: 50010
      source_domain: table
      target_domain: hand
      command: ["./target/release/saga-table-hand"]
      env:
        RUST_LOG: info
        UDS_BASE_PATH: /tmp/angzarr-poker-rust

    - name: saga-hand-table
      port: 50011
      source_domain: hand
      target_domain: table
      command: ["./target/release/saga-hand-table"]
      env:
        RUST_LOG: info
        UDS_BASE_PATH: /tmp/angzarr-poker-rust

    - name: saga-table-player
      port: 50013
      source_domain: table
      target_domain: player
      command: ["./target/release/saga-table-player"]
      env:
        RUST_LOG: info
        UDS_BASE_PATH: /tmp/angzarr-poker-rust

    - name: saga-hand-player
      port: 50014
      source_domain: hand
      target_domain: player
      command: ["./target/release/saga-hand-player"]
      env:
        RUST_LOG: info
        UDS_BASE_PATH: /tmp/angzarr-poker-rust

  process_managers:
    - name: pmg-hand-flow
      port: 50091
      pm_domain: hand-flow
      input_domains: [table, hand]
      command: ["./target/release/pmg-hand-flow"]
      env:
        RUST_LOG: info
        UDS_BASE_PATH: /tmp/angzarr-poker-rust

  projectors:
    - name: prj-output
      port: 50090
      listen_domains: [player, table, hand]
      command: ["./target/release/prj-output"]
      env:
        RUST_LOG: info
        UDS_BASE_PATH: /tmp/angzarr-poker-rust
        HAND_LOG_FILE: ./hand_log.txt

  gateway:
    enabled: true
    port: 9084
