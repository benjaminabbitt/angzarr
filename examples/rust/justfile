# Rust poker examples

set shell := ["bash", "-c"]

TOP := `git rev-parse --show-toplevel`

# Default: list available commands
default:
    @just --list

# Build all poker aggregates (release)
build:
    cargo build --release

# Build all poker aggregates (debug)
build-dev:
    cargo build

# Run poker in standalone mode (player:50001, table:50002, hand:50003)
run: build
    mkdir -p "{{TOP}}/examples/rust/data"
    cd "{{TOP}}" && cargo run \
        --bin angzarr-standalone \
        --features standalone,sqlite \
        -- --config examples/rust/standalone.yaml

# Run poker in standalone mode (debug build)
run-dev: build-dev
    mkdir -p "{{TOP}}/examples/rust/data"
    cargo run --manifest-path "{{TOP}}/Cargo.toml" \
        --bin angzarr-standalone \
        --features standalone,sqlite \
        -- --config "{{TOP}}/examples/rust/standalone.yaml"

# Run tests
test:
    cargo test

# Check code compiles
check:
    cargo check

# Format code
fmt:
    cargo fmt

# Lint code
lint:
    cargo clippy -- -D warnings

# Clean build artifacts
clean:
    cargo clean
    rm -rf data/
