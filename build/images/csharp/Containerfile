# syntax=docker/dockerfile:1.4
# C# build image for angzarr
#
# Build: podman build -t ghcr.io/angzarr-io/angzarr-csharp .
#
# Provides: .NET SDK 8.0
# Based on: ghcr.io/angzarr-io/angzarr-base

ARG BASE_IMAGE=ghcr.io/angzarr-io/angzarr-base:latest
FROM ${BASE_IMAGE}

ARG DOTNET_VERSION=8.0

# Install .NET SDK using official install script (supports multi-arch)
# libicu is required for .NET globalization support
RUN apt-get update && apt-get install -y --no-install-recommends \
    wget \
    ca-certificates \
    libicu72 \
    && wget https://dot.net/v1/dotnet-install.sh -O /tmp/dotnet-install.sh \
    && chmod +x /tmp/dotnet-install.sh \
    && /tmp/dotnet-install.sh --channel ${DOTNET_VERSION} --install-dir /usr/share/dotnet \
    && ln -s /usr/share/dotnet/dotnet /usr/bin/dotnet \
    && rm /tmp/dotnet-install.sh \
    && rm -rf /var/lib/apt/lists/*

# Disable telemetry
ENV DOTNET_CLI_TELEMETRY_OPTOUT=1 \
    DOTNET_NOLOGO=1

# Verify installation
RUN dotnet --version

WORKDIR /workspace
