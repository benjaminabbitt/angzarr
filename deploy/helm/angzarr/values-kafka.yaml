# Kafka-specific values for angzarr
# Usage: helm install angzarr ./deploy/helm/angzarr -f values-kafka.yaml

# Use Kafka instead of RabbitMQ
messaging:
  type: kafka

  amqp:
    enabled: false

  kafka:
    enabled: true
    bootstrapServers: "kafka:9092"
    topicPrefix: "angzarr"
    # For authenticated clusters:
    # securityProtocol: "SASL_PLAINTEXT"
    # saslMechanism: "SCRAM-SHA-256"
    # saslUsername: "angzarr"
    # saslPassword: ""  # Set via --set or secret
    # For TLS:
    # securityProtocol: "SASL_SSL"
    # sslCaLocation: "/etc/ssl/certs/ca-certificates.crt"

# Disable RabbitMQ
rabbitmq:
  enabled: false

# Enable Kafka subchart
kafka:
  enabled: true

  # KRaft mode (no ZooKeeper)
  controller:
    replicaCount: 1
    persistence:
      size: 2Gi
    resources:
      requests:
        memory: 512Mi
        cpu: 250m
      limits:
        memory: 1Gi
        cpu: 1

  broker:
    replicaCount: 1
    persistence:
      size: 2Gi
    resources:
      requests:
        memory: 512Mi
        cpu: 250m
      limits:
        memory: 1Gi
        cpu: 1

  # For production, enable SASL authentication:
  # sasl:
  #   client:
  #     users:
  #       - angzarr
  #     passwords: ""  # Set via --set kafka.sasl.client.passwords=<password>
  #   interbroker:
  #     user: interbroker
  #     password: ""
  #   controller:
  #     user: controller
  #     password: ""
  # listeners:
  #   client:
  #     protocol: SASL_PLAINTEXT

  # Topic auto-creation for development
  autoCreateTopicsEnable: true

  # Log retention
  logRetentionHours: 168  # 7 days
