{
  "annotations": { "list": [] },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "title": "System Topology",
      "description": "Live component graph discovered from event stream. Nodes are aggregates, sagas, process managers, and projectors. Edges represent event/command flows via correlation_id chains.\n\nNode colors indicate component type:\n- Purple: Aggregates\n- Blue: Sagas\n- Green: Process Managers\n- Yellow: Projectors\n\nEdge thickness indicates event volume.",
      "type": "nodeGraph",
      "gridPos": { "h": 24, "w": 24, "x": 0, "y": 0 },
      "datasource": { "type": "yesoreyeram-infinity-datasource", "uid": "topology" },
      "targets": [
        {
          "refId": "nodes",
          "type": "json",
          "parser": "backend",
          "source": "url",
          "format": "table",
          "url": "http://angzarr-topology.angzarr.svc.cluster.local:9099/api/graph/data",
          "url_options": { "method": "GET" },
          "root_selector": "nodes",
          "columns": [
            { "selector": "id", "text": "id", "type": "string" },
            { "selector": "title", "text": "title", "type": "string" },
            { "selector": "subTitle", "text": "subTitle", "type": "string" },
            { "selector": "mainStat", "text": "mainStat", "type": "string" },
            { "selector": "secondaryStat", "text": "secondaryStat", "type": "string" },
            { "selector": "color", "text": "color", "type": "string" },
            { "selector": "detail__component_type", "text": "detail__component_type", "type": "string" },
            { "selector": "detail__domain", "text": "detail__domain", "type": "string" },
            { "selector": "detail__event_count", "text": "detail__event_count", "type": "number" },
            { "selector": "detail__last_event_type", "text": "detail__last_event_type", "type": "string" },
            { "selector": "detail__last_seen", "text": "detail__last_seen", "type": "string" }
          ]
        },
        {
          "refId": "edges",
          "type": "json",
          "parser": "backend",
          "source": "url",
          "format": "table",
          "url": "http://angzarr-topology.angzarr.svc.cluster.local:9099/api/graph/data",
          "url_options": { "method": "GET" },
          "root_selector": "edges",
          "columns": [
            { "selector": "id", "text": "id", "type": "string" },
            { "selector": "source", "text": "source", "type": "string" },
            { "selector": "target", "text": "target", "type": "string" },
            { "selector": "mainStat", "text": "mainStat", "type": "string" },
            { "selector": "secondaryStat", "text": "secondaryStat", "type": "string" },
            { "selector": "detail__event_count", "text": "detail__event_count", "type": "number" },
            { "selector": "detail__event_types", "text": "detail__event_types", "type": "string" },
            { "selector": "detail__last_correlation_id", "text": "detail__last_correlation_id", "type": "string" },
            { "selector": "detail__last_seen", "text": "detail__last_seen", "type": "string" },
            { "selector": "color", "text": "color", "type": "string" },
            { "selector": "thickness", "text": "thickness", "type": "number" }
          ]
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": {
            "nodeRadius": {
              "fixed": 30,
              "field": "detail__event_count",
              "min": 20,
              "max": 50
            }
          }
        },
        "overrides": []
      },
      "options": {
        "nodes": {
          "mainStatUnit": "",
          "secondaryStatUnit": "",
          "arcs": []
        },
        "edges": {
          "mainStatUnit": "",
          "secondaryStatUnit": ""
        }
      }
    },
    {
      "title": "Topology Stats",
      "type": "stat",
      "gridPos": { "h": 4, "w": 6, "x": 0, "y": 24 },
      "datasource": { "type": "yesoreyeram-infinity-datasource", "uid": "topology" },
      "targets": [
        {
          "refId": "A",
          "type": "json",
          "parser": "backend",
          "source": "url",
          "format": "table",
          "url": "http://angzarr-topology.angzarr.svc.cluster.local:9099/api/graph/data",
          "url_options": { "method": "GET" },
          "root_selector": "nodes",
          "columns": [
            { "selector": "id", "text": "id", "type": "string" }
          ]
        }
      ],
      "transformations": [
        {
          "id": "reduce",
          "options": {
            "reducers": ["count"]
          }
        }
      ],
      "fieldConfig": {
        "defaults": {
          "displayName": "Components",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null }
            ]
          }
        },
        "overrides": []
      },
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "textMode": "auto",
        "reduceOptions": {
          "values": false,
          "calcs": ["count"],
          "fields": "/^id$/"
        }
      }
    },
    {
      "title": "About This Dashboard",
      "type": "text",
      "gridPos": { "h": 4, "w": 18, "x": 6, "y": 24 },
      "options": {
        "mode": "markdown",
        "content": "## Runtime Topology Visualization\n\nThis dashboard displays the live topology of your Angzarr event-sourced system.\n\n**Nodes** represent components:\n- **Aggregates** - Domain entities that process commands and emit events\n- **Sagas** - Cross-domain orchestrators that react to events\n- **Process Managers** - Long-running workflows coordinating multiple domains\n\n**Edges** show event flow between components, tracked via correlation IDs.\n\nData is automatically discovered from the event stream - no manual configuration required."
      }
    }
  ],
  "refresh": "30s",
  "schemaVersion": 39,
  "tags": ["angzarr", "topology", "node-graph", "event-sourcing"],
  "templating": { "list": [] },
  "time": { "from": "now-1h", "to": "now" },
  "timepicker": {
    "refresh_intervals": ["5s", "10s", "30s", "1m", "5m"]
  },
  "timezone": "browser",
  "title": "Angzarr: Topology",
  "uid": "angzarr-topology",
  "version": 1
}
