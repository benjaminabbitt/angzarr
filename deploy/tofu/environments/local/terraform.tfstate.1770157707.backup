{"version":4,"terraform_version":"1.8.8","serial":190,"lineage":"f2e0ffcb-a8ab-c99d-81ed-b53972ed4dfe","outputs":{"grafana_url":{"value":"http://localhost:3000","type":"string"},"mesh_enabled":{"value":false,"type":"bool"},"namespace":{"value":"angzarr","type":"string"},"observability_enabled":{"value":true,"type":"bool"},"otel_collector_endpoint":{"value":"angzarr-otel-collector-opentelemetry-collector.monitoring.svc.cluster.local:4317","type":"string"},"secrets_source":{"value":"kubernetes_secret/angzarr-secrets/angzarr-secrets","type":"string"}},"resources":[{"mode":"data","type":"kubernetes_secret","name":"angzarr_secrets","provider":"provider[\"registry.opentofu.org/hashicorp/kubernetes\"]","instances":[{"schema_version":0,"attributes":{"binary_data":null,"data":{"eventstoredb-password":"dn2sfVKMGdU1j6FyAFcNWaWKPRKSc4bf","kafka-password":"TmZdKgqL8veimqWQGArfTXzqRGQBpuoq","mongodb-password":"SyU1K19Cj1MVnaQRk7ZdOJ9X65JOfqC9","mongodb-root-password":"V3il9FBaMRC9b1w2WwpsaK7tD7CmTNlt","postgres-admin-password":"B1nsS3c8ENgOZrNiafMCcAbLbj4VQ23h","postgres-password":"1v82geR1SR4dFEI4FmuQ4Ipu2cSFJHZU","rabbitmq-erlang-cookie":"Qb8s8LGmXco4CQigdcIPf6ooiPfnaNtm26PoH6DyxHk=","rabbitmq-password":"NyE0ydXtTUsZNTSuzb4AgBTIVyGbc0Uh","redis-password":"NbVqGyc2dgP3Jgi6bwUuuJ7iOZJK4GGR"},"id":"angzarr-secrets/angzarr-secrets","immutable":false,"metadata":[{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"v1\",\"data\":{\"eventstoredb-password\":\"ZG4yc2ZWS01HZFUxajZGeUFGY05XYVdLUFJLU2M0YmY=\",\"kafka-password\":\"VG1aZEtncUw4dmVpbXFXUUdBcmZUWHpxUkdRQnB1b3E=\",\"mongodb-password\":\"U3lVMUsxOUNqMU1WbmFRUms3WmRPSjlYNjVKT2ZxQzk=\",\"mongodb-root-password\":\"VjNpbDlGQmFNUkM5YjF3Mld3cHNhSzd0RDdDbVRObHQ=\",\"postgres-admin-password\":\"QjFuc1MzYzhFTmdPWnJOaWFmTUNjQWJMYmo0VlEyM2g=\",\"postgres-password\":\"MXY4MmdlUjFTUjRkRkVJNEZtdVE0SXB1MmNTRkpIWlU=\",\"rabbitmq-erlang-cookie\":\"UWI4czhMR21YY280Q1FpZ2RjSVBmNm9vaVBmbmFOdG0yNlBvSDZEeXhIaz0=\",\"rabbitmq-password\":\"TnlFMHlkWHRUVXNaTlRTdXpiNEFnQlRJVnlHYmMwVWg=\",\"redis-password\":\"TmJWcUd5YzJkZ1AzSmdpNmJ3VXV1SjdpT1pKSzRHR1I=\"},\"kind\":\"Secret\",\"metadata\":{\"annotations\":{},\"creationTimestamp\":null,\"name\":\"angzarr-secrets\",\"namespace\":\"angzarr-secrets\"}}\n"},"generate_name":"","generation":0,"labels":{},"name":"angzarr-secrets","namespace":"angzarr-secrets","resource_version":"389","uid":"bc4763a1-31c0-4290-89ff-47a8fee14917"}],"type":"Opaque"},"sensitive_attributes":[]}]},{"mode":"managed","type":"kubernetes_namespace","name":"angzarr","provider":"provider[\"registry.opentofu.org/hashicorp/kubernetes\"]","instances":[{"schema_version":0,"attributes":{"id":"angzarr","metadata":[{"annotations":{},"generate_name":"","generation":0,"labels":{},"name":"angzarr","resource_version":"467","uid":"e0e303c0-366b-40e8-89eb-58a42b4f9e80"}],"timeouts":null,"wait_for_default_service_account":false},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiZGVsZXRlIjozMDAwMDAwMDAwMDB9fQ=="}]},{"module":"module.observability[0]","mode":"managed","type":"helm_release","name":"grafana","provider":"provider[\"registry.opentofu.org/hashicorp/helm\"]","instances":[{"schema_version":1,"attributes":{"atomic":false,"chart":"grafana","cleanup_on_fail":false,"create_namespace":false,"dependency_update":false,"description":null,"devel":null,"disable_crd_hooks":false,"disable_openapi_validation":false,"disable_webhooks":false,"force_update":false,"id":"angzarr-grafana","keyring":null,"lint":false,"manifest":null,"max_history":0,"metadata":[{"app_version":"11.4.0","chart":"grafana","first_deployed":1770157349,"last_deployed":1770157349,"name":"angzarr-grafana","namespace":"monitoring","notes":"1. Get your 'admin' user password by running:\n\n   kubectl get secret --namespace monitoring angzarr-grafana -o jsonpath=\"{.data.admin-password}\" | base64 --decode ; echo\n\n\n2. The Grafana server can be accessed via port 80 on the following DNS name from within your cluster:\n\n   angzarr-grafana.monitoring.svc.cluster.local\n\n   Get the Grafana URL to visit by running these commands in the same shell:\n     export NODE_PORT=$(kubectl get --namespace monitoring -o jsonpath=\"{.spec.ports[0].nodePort}\" services angzarr-grafana)\n     export NODE_IP=$(kubectl get nodes --namespace monitoring -o jsonpath=\"{.items[0].status.addresses[0].address}\")\n     echo http://$NODE_IP:$NODE_PORT\n\n3. Login with the password from step 1 and the username: admin\n#################################################################################\n######   WARNING: Persistence is disabled!!! You will lose your data when   #####\n######            the Grafana pod is terminated.                            #####\n#################################################################################\n","revision":1,"values":"{\"adminPassword\":\"angzarr\",\"adminUser\":\"admin\",\"datasources\":{\"datasources.yaml\":{\"apiVersion\":1,\"datasources\":[{\"access\":\"proxy\",\"isDefault\":false,\"jsonData\":{\"tracesToLogsV2\":{\"datasourceUid\":\"loki\",\"filterByTraceID\":true},\"tracesToMetrics\":{\"datasourceUid\":\"prometheus\"}},\"name\":\"Tempo\",\"type\":\"tempo\",\"url\":\"http://angzarr-tempo.monitoring.svc.cluster.local:3100\"},{\"access\":\"proxy\",\"isDefault\":true,\"name\":\"Prometheus\",\"type\":\"prometheus\",\"uid\":\"prometheus\",\"url\":\"http://angzarr-prometheus-server.monitoring.svc.cluster.local:80\"},{\"access\":\"proxy\",\"jsonData\":{\"derivedFields\":[{\"datasourceUid\":\"tempo\",\"matcherRegex\":\"trace_id=(\\\\w+)\",\"name\":\"TraceID\",\"url\":\"${__value.raw}\"}]},\"name\":\"Loki\",\"type\":\"loki\",\"uid\":\"loki\",\"url\":\"http://angzarr-loki.monitoring.svc.cluster.local:3100\"},{\"access\":\"proxy\",\"isDefault\":false,\"jsonData\":{\"url\":\"http://angzarr-topology.angzarr.svc.cluster.local:9099\"},\"name\":\"Angzarr Topology\",\"type\":\"hamedkarbasi93-nodegraphapi-datasource\",\"uid\":\"topology\",\"url\":\"http://angzarr-topology.angzarr.svc.cluster.local:9099\"}]}},\"grafana.ini\":{\"server\":{\"root_url\":\"http://localhost:3000\"}},\"plugins\":[\"hamedkarbasi93-nodegraphapi-datasource\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"50m\",\"memory\":\"128Mi\"}},\"service\":{\"nodePort\":30300,\"type\":\"NodePort\"},\"sidecar\":{\"dashboards\":{\"enabled\":true,\"folder\":\"/var/lib/grafana/dashboards/angzarr\",\"label\":\"grafana_dashboard\",\"labelValue\":\"1\",\"provider\":{\"allowUiUpdates\":true,\"disableDeletion\":false,\"folder\":\"Angzarr\",\"name\":\"angzarr\",\"orgId\":1}}}}","version":"8.8.2"}],"name":"angzarr-grafana","namespace":"monitoring","pass_credentials":false,"postrender":[],"recreate_pods":false,"render_subchart_notes":true,"replace":false,"repository":"https://grafana.github.io/helm-charts","repository_ca_file":null,"repository_cert_file":null,"repository_key_file":null,"repository_password":null,"repository_username":null,"reset_values":false,"reuse_values":false,"set":[],"set_list":[],"set_sensitive":[],"skip_crds":false,"status":"deployed","timeout":300,"upgrade_install":null,"values":["\"adminPassword\": \"angzarr\"\n\"adminUser\": \"admin\"\n\"datasources\":\n  \"datasources.yaml\":\n    \"apiVersion\": 1\n    \"datasources\":\n    - \"access\": \"proxy\"\n      \"isDefault\": false\n      \"jsonData\":\n        \"tracesToLogsV2\":\n          \"datasourceUid\": \"loki\"\n          \"filterByTraceID\": true\n        \"tracesToMetrics\":\n          \"datasourceUid\": \"prometheus\"\n      \"name\": \"Tempo\"\n      \"type\": \"tempo\"\n      \"url\": \"http://angzarr-tempo.monitoring.svc.cluster.local:3100\"\n    - \"access\": \"proxy\"\n      \"isDefault\": true\n      \"name\": \"Prometheus\"\n      \"type\": \"prometheus\"\n      \"uid\": \"prometheus\"\n      \"url\": \"http://angzarr-prometheus-server.monitoring.svc.cluster.local:80\"\n    - \"access\": \"proxy\"\n      \"jsonData\":\n        \"derivedFields\":\n        - \"datasourceUid\": \"tempo\"\n          \"matcherRegex\": \"trace_id=(\\\\w+)\"\n          \"name\": \"TraceID\"\n          \"url\": \"${__value.raw}\"\n      \"name\": \"Loki\"\n      \"type\": \"loki\"\n      \"uid\": \"loki\"\n      \"url\": \"http://angzarr-loki.monitoring.svc.cluster.local:3100\"\n    - \"access\": \"proxy\"\n      \"isDefault\": false\n      \"jsonData\":\n        \"url\": \"http://angzarr-topology.angzarr.svc.cluster.local:9099\"\n      \"name\": \"Angzarr Topology\"\n      \"type\": \"hamedkarbasi93-nodegraphapi-datasource\"\n      \"uid\": \"topology\"\n      \"url\": \"http://angzarr-topology.angzarr.svc.cluster.local:9099\"\n\"grafana.ini\":\n  \"server\":\n    \"root_url\": \"http://localhost:3000\"\n\"plugins\":\n- \"hamedkarbasi93-nodegraphapi-datasource\"\n\"resources\":\n  \"limits\":\n    \"cpu\": \"500m\"\n    \"memory\": \"512Mi\"\n  \"requests\":\n    \"cpu\": \"50m\"\n    \"memory\": \"128Mi\"\n\"service\":\n  \"nodePort\": 30300\n  \"type\": \"NodePort\"\n\"sidecar\":\n  \"dashboards\":\n    \"enabled\": true\n    \"folder\": \"/var/lib/grafana/dashboards/angzarr\"\n    \"label\": \"grafana_dashboard\"\n    \"labelValue\": \"1\"\n    \"provider\":\n      \"allowUiUpdates\": true\n      \"disableDeletion\": false\n      \"folder\": \"Angzarr\"\n      \"name\": \"angzarr\"\n      \"orgId\": 1\n"],"verify":false,"version":"8.8.2","wait":true,"wait_for_jobs":false},"sensitive_attributes":[[{"type":"get_attr","value":"repository_password"}],[{"type":"get_attr","value":"values"},{"type":"index","value":{"value":0,"type":"number"}}]],"private":"eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==","dependencies":["module.observability.helm_release.loki","module.observability.helm_release.prometheus","module.observability.helm_release.tempo","module.observability.kubernetes_namespace.monitoring"]}]},{"module":"module.observability[0]","mode":"managed","type":"helm_release","name":"loki","provider":"provider[\"registry.opentofu.org/hashicorp/helm\"]","instances":[{"schema_version":1,"attributes":{"atomic":false,"chart":"loki","cleanup_on_fail":false,"create_namespace":false,"dependency_update":false,"description":null,"devel":null,"disable_crd_hooks":false,"disable_openapi_validation":false,"disable_webhooks":false,"force_update":false,"id":"angzarr-loki","keyring":null,"lint":false,"manifest":null,"max_history":0,"metadata":[{"app_version":"3.3.2","chart":"loki","first_deployed":1770132760,"last_deployed":1770132760,"name":"angzarr-loki","namespace":"monitoring","notes":"***********************************************************************\n Welcome to Grafana Loki\n Chart version: 6.24.0\n Chart Name: loki\n Loki version: 3.3.2\n***********************************************************************\n\n** Please be patient while the chart is being deployed **\n\nTip:\n\n  Watch the deployment status using the command: kubectl get pods -w --namespace monitoring\n\nIf pods are taking too long to schedule make sure pod affinity can be fulfilled in the current cluster.\n\n***********************************************************************\nInstalled components:\n***********************************************************************\n* loki\n\nLoki has been deployed as a single binary.\nThis means a single pod is handling reads and writes. You can scale that pod vertically by adding more CPU and memory resources.\n\n\n***********************************************************************\nSending logs to Loki\n***********************************************************************\n\nYou can send logs from inside the cluster using the cluster DNS:\n\nhttp://angzarr-loki.monitoring.svc.cluster.local:3100/loki/api/v1/push\n\nYou can test to send data from outside the cluster by port-forwarding the gateway to your local machine:\n\n  kubectl port-forward --namespace monitoring svc/angzarr-loki 3100:3100 \u0026\n\nAnd then using http://127.0.0.1:3100/loki/api/v1/push URL as shown below:\n\n```\ncurl -H \"Content-Type: application/json\" -XPOST -s \"http://127.0.0.1:3100/loki/api/v1/push\"  \\\n--data-raw \"{\\\"streams\\\": [{\\\"stream\\\": {\\\"job\\\": \\\"test\\\"}, \\\"values\\\": [[\\\"$(date +%s)000000000\\\", \\\"fizzbuzz\\\"]]}]}\"\n```\n\nThen verify that Loki did received the data using the following command:\n\n```\ncurl \"http://127.0.0.1:3100/loki/api/v1/query_range\" --data-urlencode 'query={job=\"test\"}' | jq .data.result\n```\n\n***********************************************************************\nConnecting Grafana to Loki\n***********************************************************************\n\nIf Grafana operates within the cluster, you'll set up a new Loki datasource by utilizing the following URL:\n\nhttp://angzarr-loki.monitoring.svc.cluster.local:3100/\n","revision":1,"values":"{\"backend\":{\"replicas\":0},\"deploymentMode\":\"SingleBinary\",\"gateway\":{\"enabled\":false},\"loki\":{\"auth_enabled\":false,\"commonConfig\":{\"replication_factor\":1},\"schemaConfig\":{\"configs\":[{\"from\":\"2024-01-01\",\"index\":{\"period\":\"24h\",\"prefix\":\"index_\"},\"object_store\":\"filesystem\",\"schema\":\"v13\",\"store\":\"tsdb\"}]},\"storage\":{\"type\":\"filesystem\"}},\"read\":{\"replicas\":0},\"singleBinary\":{\"replicas\":1,\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"50m\",\"memory\":\"128Mi\"}}},\"write\":{\"replicas\":0}}","version":"6.24.0"}],"name":"angzarr-loki","namespace":"monitoring","pass_credentials":false,"postrender":[],"recreate_pods":false,"render_subchart_notes":true,"replace":false,"repository":"https://grafana.github.io/helm-charts","repository_ca_file":null,"repository_cert_file":null,"repository_key_file":null,"repository_password":null,"repository_username":null,"reset_values":false,"reuse_values":false,"set":[],"set_list":[],"set_sensitive":[],"skip_crds":false,"status":"deployed","timeout":300,"upgrade_install":null,"values":["\"backend\":\n  \"replicas\": 0\n\"deploymentMode\": \"SingleBinary\"\n\"gateway\":\n  \"enabled\": false\n\"loki\":\n  \"auth_enabled\": false\n  \"commonConfig\":\n    \"replication_factor\": 1\n  \"schemaConfig\":\n    \"configs\":\n    - \"from\": \"2024-01-01\"\n      \"index\":\n        \"period\": \"24h\"\n        \"prefix\": \"index_\"\n      \"object_store\": \"filesystem\"\n      \"schema\": \"v13\"\n      \"store\": \"tsdb\"\n  \"storage\":\n    \"type\": \"filesystem\"\n\"read\":\n  \"replicas\": 0\n\"singleBinary\":\n  \"replicas\": 1\n  \"resources\":\n    \"limits\":\n      \"cpu\": \"500m\"\n      \"memory\": \"512Mi\"\n    \"requests\":\n      \"cpu\": \"50m\"\n      \"memory\": \"128Mi\"\n\"write\":\n  \"replicas\": 0\n"],"verify":false,"version":"6.24.0","wait":true,"wait_for_jobs":false},"sensitive_attributes":[[{"type":"get_attr","value":"repository_password"}]],"private":"eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==","dependencies":["module.observability.kubernetes_namespace.monitoring"]}]},{"module":"module.observability[0]","mode":"managed","type":"helm_release","name":"otel_collector","provider":"provider[\"registry.opentofu.org/hashicorp/helm\"]","instances":[{"schema_version":1,"attributes":{"atomic":false,"chart":"opentelemetry-collector","cleanup_on_fail":false,"create_namespace":false,"dependency_update":false,"description":null,"devel":null,"disable_crd_hooks":false,"disable_openapi_validation":false,"disable_webhooks":false,"force_update":false,"id":"angzarr-otel-collector","keyring":null,"lint":false,"manifest":null,"max_history":0,"metadata":[{"app_version":"0.111.0","chart":"opentelemetry-collector","first_deployed":1770157347,"last_deployed":1770157347,"name":"angzarr-otel-collector","namespace":"monitoring","notes":"\n\n\n","revision":1,"values":"{\"config\":{\"exporters\":{\"debug\":{\"verbosity\":\"basic\"},\"otlp\":{\"endpoint\":\"angzarr-tempo.monitoring.svc.cluster.local:4317\",\"tls\":{\"insecure\":true}},\"otlphttp/loki\":{\"endpoint\":\"http://angzarr-loki.monitoring.svc.cluster.local:3100/otlp\",\"tls\":{\"insecure\":true}},\"prometheusremotewrite\":{\"endpoint\":\"http://angzarr-prometheus-server.monitoring.svc.cluster.local:80/api/v1/write\",\"tls\":{\"insecure\":true}}},\"processors\":{\"batch\":{\"send_batch_size\":1024,\"timeout\":\"5s\"},\"memory_limiter\":{\"check_interval\":\"1s\",\"limit_percentage\":80,\"spike_limit_percentage\":25}},\"receivers\":{\"otlp\":{\"protocols\":{\"grpc\":{\"endpoint\":\"0.0.0.0:4317\"},\"http\":{\"endpoint\":\"0.0.0.0:4318\"}}}},\"service\":{\"pipelines\":{\"logs\":{\"exporters\":[\"otlphttp/loki\"],\"processors\":[\"memory_limiter\",\"batch\"],\"receivers\":[\"otlp\"]},\"metrics\":{\"exporters\":[\"prometheusremotewrite\"],\"processors\":[\"memory_limiter\",\"batch\"],\"receivers\":[\"otlp\"]},\"traces\":{\"exporters\":[\"otlp\"],\"processors\":[\"memory_limiter\",\"batch\"],\"receivers\":[\"otlp\"]}}}},\"image\":{\"repository\":\"otel/opentelemetry-collector-contrib\"},\"mode\":\"deployment\",\"ports\":{\"otlp\":{\"containerPort\":4317,\"enabled\":true,\"hostPort\":4317,\"nodePort\":30417,\"protocol\":\"TCP\",\"servicePort\":4317},\"otlp-http\":{\"containerPort\":4318,\"enabled\":true,\"protocol\":\"TCP\",\"servicePort\":4318}},\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"50m\",\"memory\":\"128Mi\"}},\"service\":{\"type\":\"NodePort\"}}","version":"0.108.0"}],"name":"angzarr-otel-collector","namespace":"monitoring","pass_credentials":false,"postrender":[],"recreate_pods":false,"render_subchart_notes":true,"replace":false,"repository":"https://open-telemetry.github.io/opentelemetry-helm-charts","repository_ca_file":null,"repository_cert_file":null,"repository_key_file":null,"repository_password":null,"repository_username":null,"reset_values":false,"reuse_values":false,"set":[],"set_list":[],"set_sensitive":[],"skip_crds":false,"status":"deployed","timeout":300,"upgrade_install":null,"values":["\"config\":\n  \"exporters\":\n    \"debug\":\n      \"verbosity\": \"basic\"\n    \"otlp\":\n      \"endpoint\": \"angzarr-tempo.monitoring.svc.cluster.local:4317\"\n      \"tls\":\n        \"insecure\": true\n    \"otlphttp/loki\":\n      \"endpoint\": \"http://angzarr-loki.monitoring.svc.cluster.local:3100/otlp\"\n      \"tls\":\n        \"insecure\": true\n    \"prometheusremotewrite\":\n      \"endpoint\": \"http://angzarr-prometheus-server.monitoring.svc.cluster.local:80/api/v1/write\"\n      \"tls\":\n        \"insecure\": true\n  \"processors\":\n    \"batch\":\n      \"send_batch_size\": 1024\n      \"timeout\": \"5s\"\n    \"memory_limiter\":\n      \"check_interval\": \"1s\"\n      \"limit_percentage\": 80\n      \"spike_limit_percentage\": 25\n  \"receivers\":\n    \"otlp\":\n      \"protocols\":\n        \"grpc\":\n          \"endpoint\": \"0.0.0.0:4317\"\n        \"http\":\n          \"endpoint\": \"0.0.0.0:4318\"\n  \"service\":\n    \"pipelines\":\n      \"logs\":\n        \"exporters\":\n        - \"otlphttp/loki\"\n        \"processors\":\n        - \"memory_limiter\"\n        - \"batch\"\n        \"receivers\":\n        - \"otlp\"\n      \"metrics\":\n        \"exporters\":\n        - \"prometheusremotewrite\"\n        \"processors\":\n        - \"memory_limiter\"\n        - \"batch\"\n        \"receivers\":\n        - \"otlp\"\n      \"traces\":\n        \"exporters\":\n        - \"otlp\"\n        \"processors\":\n        - \"memory_limiter\"\n        - \"batch\"\n        \"receivers\":\n        - \"otlp\"\n\"image\":\n  \"repository\": \"otel/opentelemetry-collector-contrib\"\n\"mode\": \"deployment\"\n\"ports\":\n  \"otlp\":\n    \"containerPort\": 4317\n    \"enabled\": true\n    \"hostPort\": 4317\n    \"nodePort\": 30417\n    \"protocol\": \"TCP\"\n    \"servicePort\": 4317\n  \"otlp-http\":\n    \"containerPort\": 4318\n    \"enabled\": true\n    \"protocol\": \"TCP\"\n    \"servicePort\": 4318\n\"resources\":\n  \"limits\":\n    \"cpu\": \"500m\"\n    \"memory\": \"512Mi\"\n  \"requests\":\n    \"cpu\": \"50m\"\n    \"memory\": \"128Mi\"\n\"service\":\n  \"type\": \"NodePort\"\n"],"verify":false,"version":"0.108.0","wait":true,"wait_for_jobs":false},"sensitive_attributes":[[{"type":"get_attr","value":"repository_password"}]],"private":"eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==","dependencies":["module.observability.helm_release.loki","module.observability.helm_release.prometheus","module.observability.helm_release.tempo","module.observability.kubernetes_namespace.monitoring"]}]},{"module":"module.observability[0]","mode":"managed","type":"helm_release","name":"prometheus","provider":"provider[\"registry.opentofu.org/hashicorp/helm\"]","instances":[{"schema_version":1,"attributes":{"atomic":false,"chart":"prometheus","cleanup_on_fail":false,"create_namespace":false,"dependency_update":false,"description":null,"devel":null,"disable_crd_hooks":false,"disable_openapi_validation":false,"disable_webhooks":false,"force_update":false,"id":"angzarr-prometheus","keyring":null,"lint":false,"manifest":null,"max_history":0,"metadata":[{"app_version":"v3.1.0","chart":"prometheus","first_deployed":1770132755,"last_deployed":1770132755,"name":"angzarr-prometheus","namespace":"monitoring","notes":"The Prometheus server can be accessed via port 80 on the following DNS name from within your cluster:\nangzarr-prometheus-server.monitoring.svc.cluster.local\n\n\nGet the Prometheus server URL by running these commands in the same shell:\n  export POD_NAME=$(kubectl get pods --namespace monitoring -l \"app.kubernetes.io/name=prometheus,app.kubernetes.io/instance=angzarr-prometheus\" -o jsonpath=\"{.items[0].metadata.name}\")\n  kubectl --namespace monitoring port-forward $POD_NAME 9090\n#################################################################################\n######   WARNING: Persistence is disabled!!! You will lose your data when   #####\n######            the Server pod is terminated.                             #####\n#################################################################################\n\n\n\n\n\nFor more information on running Prometheus, visit:\nhttps://prometheus.io/\n","revision":1,"values":"{\"alertmanager\":{\"enabled\":false},\"kube-state-metrics\":{\"enabled\":false},\"prometheus-node-exporter\":{\"enabled\":false},\"prometheus-pushgateway\":{\"enabled\":false},\"server\":{\"extraFlags\":[\"web.enable-remote-write-receiver\"],\"persistentVolume\":{\"enabled\":false},\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"50m\",\"memory\":\"128Mi\"}},\"retention\":\"24h\"}}","version":"27.3.1"}],"name":"angzarr-prometheus","namespace":"monitoring","pass_credentials":false,"postrender":[],"recreate_pods":false,"render_subchart_notes":true,"replace":false,"repository":"https://prometheus-community.github.io/helm-charts","repository_ca_file":null,"repository_cert_file":null,"repository_key_file":null,"repository_password":null,"repository_username":null,"reset_values":false,"reuse_values":false,"set":[],"set_list":[],"set_sensitive":[],"skip_crds":false,"status":"deployed","timeout":300,"upgrade_install":null,"values":["\"alertmanager\":\n  \"enabled\": false\n\"kube-state-metrics\":\n  \"enabled\": false\n\"prometheus-node-exporter\":\n  \"enabled\": false\n\"prometheus-pushgateway\":\n  \"enabled\": false\n\"server\":\n  \"extraFlags\":\n  - \"web.enable-remote-write-receiver\"\n  \"persistentVolume\":\n    \"enabled\": false\n  \"resources\":\n    \"limits\":\n      \"cpu\": \"500m\"\n      \"memory\": \"512Mi\"\n    \"requests\":\n      \"cpu\": \"50m\"\n      \"memory\": \"128Mi\"\n  \"retention\": \"24h\"\n"],"verify":false,"version":"27.3.1","wait":true,"wait_for_jobs":false},"sensitive_attributes":[[{"type":"get_attr","value":"repository_password"}]],"private":"eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==","dependencies":["module.observability.kubernetes_namespace.monitoring"]}]},{"module":"module.observability[0]","mode":"managed","type":"helm_release","name":"promtail","provider":"provider[\"registry.opentofu.org/hashicorp/helm\"]","instances":[{"schema_version":1,"attributes":{"atomic":false,"chart":"promtail","cleanup_on_fail":false,"create_namespace":false,"dependency_update":false,"description":null,"devel":null,"disable_crd_hooks":false,"disable_openapi_validation":false,"disable_webhooks":false,"force_update":false,"id":"angzarr-promtail","keyring":null,"lint":false,"manifest":null,"max_history":0,"metadata":[{"app_version":"3.0.0","chart":"promtail","first_deployed":1770132836,"last_deployed":1770132836,"name":"angzarr-promtail","namespace":"monitoring","notes":"***********************************************************************\n Welcome to Grafana Promtail\n Chart version: 6.16.6\n Promtail version: 3.0.0\n***********************************************************************\n\nVerify the application is working by running these commands:\n* kubectl --namespace monitoring port-forward daemonset/angzarr-promtail 3101\n* curl http://127.0.0.1:3101/metrics\n","revision":1,"values":"{\"config\":{\"clients\":[{\"url\":\"http://angzarr-loki.monitoring.svc.cluster.local:3100/loki/api/v1/push\"}],\"snippets\":{\"pipelineStages\":[{\"match\":{\"action\":\"drop\",\"drop_counter_reason\":\"angzarr_sidecar_otlp_duplicate\",\"selector\":\"{container=\\\"angzarr\\\"}\"}}]}},\"resources\":{\"limits\":{\"cpu\":\"100m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"25m\",\"memory\":\"64Mi\"}}}","version":"6.16.6"}],"name":"angzarr-promtail","namespace":"monitoring","pass_credentials":false,"postrender":[],"recreate_pods":false,"render_subchart_notes":true,"replace":false,"repository":"https://grafana.github.io/helm-charts","repository_ca_file":null,"repository_cert_file":null,"repository_key_file":null,"repository_password":null,"repository_username":null,"reset_values":false,"reuse_values":false,"set":[],"set_list":[],"set_sensitive":[],"skip_crds":false,"status":"deployed","timeout":300,"upgrade_install":null,"values":["\"config\":\n  \"clients\":\n  - \"url\": \"http://angzarr-loki.monitoring.svc.cluster.local:3100/loki/api/v1/push\"\n  \"snippets\":\n    \"pipelineStages\":\n    - \"match\":\n        \"action\": \"drop\"\n        \"drop_counter_reason\": \"angzarr_sidecar_otlp_duplicate\"\n        \"selector\": \"{container=\\\"angzarr\\\"}\"\n\"resources\":\n  \"limits\":\n    \"cpu\": \"100m\"\n    \"memory\": \"128Mi\"\n  \"requests\":\n    \"cpu\": \"25m\"\n    \"memory\": \"64Mi\"\n"],"verify":false,"version":"6.16.6","wait":true,"wait_for_jobs":false},"sensitive_attributes":[[{"type":"get_attr","value":"repository_password"}]],"private":"eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==","dependencies":["module.observability.helm_release.loki","module.observability.kubernetes_namespace.monitoring"]}]},{"module":"module.observability[0]","mode":"managed","type":"helm_release","name":"tempo","provider":"provider[\"registry.opentofu.org/hashicorp/helm\"]","instances":[{"schema_version":1,"attributes":{"atomic":false,"chart":"tempo","cleanup_on_fail":false,"create_namespace":false,"dependency_update":false,"description":null,"devel":null,"disable_crd_hooks":false,"disable_openapi_validation":false,"disable_webhooks":false,"force_update":false,"id":"angzarr-tempo","keyring":null,"lint":false,"manifest":null,"max_history":0,"metadata":[{"app_version":"2.6.1","chart":"tempo","first_deployed":1770132762,"last_deployed":1770132762,"name":"angzarr-tempo","namespace":"monitoring","notes":"","revision":1,"values":"{\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"50m\",\"memory\":\"128Mi\"}},\"tempo\":{\"receivers\":{\"otlp\":{\"protocols\":{\"grpc\":{\"endpoint\":\"0.0.0.0:4317\"}}}},\"storage\":{\"trace\":{\"backend\":\"local\",\"local\":{\"path\":\"/var/tempo/traces\"}}}}}","version":"1.14.0"}],"name":"angzarr-tempo","namespace":"monitoring","pass_credentials":false,"postrender":[],"recreate_pods":false,"render_subchart_notes":true,"replace":false,"repository":"https://grafana.github.io/helm-charts","repository_ca_file":null,"repository_cert_file":null,"repository_key_file":null,"repository_password":null,"repository_username":null,"reset_values":false,"reuse_values":false,"set":[],"set_list":[],"set_sensitive":[],"skip_crds":false,"status":"deployed","timeout":300,"upgrade_install":null,"values":["\"resources\":\n  \"limits\":\n    \"cpu\": \"500m\"\n    \"memory\": \"512Mi\"\n  \"requests\":\n    \"cpu\": \"50m\"\n    \"memory\": \"128Mi\"\n\"tempo\":\n  \"receivers\":\n    \"otlp\":\n      \"protocols\":\n        \"grpc\":\n          \"endpoint\": \"0.0.0.0:4317\"\n  \"storage\":\n    \"trace\":\n      \"backend\": \"local\"\n      \"local\":\n        \"path\": \"/var/tempo/traces\"\n"],"verify":false,"version":"1.14.0","wait":true,"wait_for_jobs":false},"sensitive_attributes":[[{"type":"get_attr","value":"repository_password"}]],"private":"eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==","dependencies":["module.observability.kubernetes_namespace.monitoring"]}]},{"module":"module.observability[0]","mode":"managed","type":"kubernetes_config_map","name":"dashboards","provider":"provider[\"registry.opentofu.org/hashicorp/kubernetes\"]","instances":[{"index_key":"command-pipeline.json","schema_version":0,"attributes":{"binary_data":null,"data":{"command-pipeline.json":"{\n  \"annotations\": { \"list\": [] },\n  \"editable\": true,\n  \"fiscalYearStartMonth\": 0,\n  \"graphTooltip\": 1,\n  \"id\": null,\n  \"links\": [],\n  \"panels\": [\n    {\n      \"title\": \"Command Throughput (req/s)\",\n      \"type\": \"timeseries\",\n      \"gridPos\": { \"h\": 8, \"w\": 12, \"x\": 0, \"y\": 0 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"custom\": { \"drawStyle\": \"line\", \"fillOpacity\": 10, \"lineWidth\": 2, \"stacking\": { \"mode\": \"none\" } },\n          \"unit\": \"reqps\"\n        },\n        \"overrides\": []\n      },\n      \"targets\": [\n        {\n          \"expr\": \"sum(rate(angzarr_command_total[5m])) by (domain, outcome)\",\n          \"legendFormat\": \"{{domain}} ({{outcome}})\",\n          \"refId\": \"A\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Command Latency p50/p95/p99\",\n      \"type\": \"timeseries\",\n      \"gridPos\": { \"h\": 8, \"w\": 12, \"x\": 12, \"y\": 0 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"custom\": { \"drawStyle\": \"line\", \"fillOpacity\": 5, \"lineWidth\": 2 },\n          \"unit\": \"s\"\n        },\n        \"overrides\": []\n      },\n      \"targets\": [\n        {\n          \"expr\": \"histogram_quantile(0.50, sum(rate(angzarr_command_duration_bucket[5m])) by (le, domain))\",\n          \"legendFormat\": \"p50 {{domain}}\",\n          \"refId\": \"A\"\n        },\n        {\n          \"expr\": \"histogram_quantile(0.95, sum(rate(angzarr_command_duration_bucket[5m])) by (le, domain))\",\n          \"legendFormat\": \"p95 {{domain}}\",\n          \"refId\": \"B\"\n        },\n        {\n          \"expr\": \"histogram_quantile(0.99, sum(rate(angzarr_command_duration_bucket[5m])) by (le, domain))\",\n          \"legendFormat\": \"p99 {{domain}}\",\n          \"refId\": \"C\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Command Error Rate\",\n      \"type\": \"stat\",\n      \"gridPos\": { \"h\": 4, \"w\": 6, \"x\": 0, \"y\": 8 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"unit\": \"percentunit\",\n          \"thresholds\": {\n            \"mode\": \"absolute\",\n            \"steps\": [\n              { \"color\": \"green\", \"value\": null },\n              { \"color\": \"yellow\", \"value\": 0.01 },\n              { \"color\": \"red\", \"value\": 0.05 }\n            ]\n          }\n        }\n      },\n      \"targets\": [\n        {\n          \"expr\": \"sum(rate(angzarr_command_total{outcome=\\\"error\\\"}[5m])) / sum(rate(angzarr_command_total[5m]))\",\n          \"legendFormat\": \"Error Rate\",\n          \"refId\": \"A\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Total Commands (last 24h)\",\n      \"type\": \"stat\",\n      \"gridPos\": { \"h\": 4, \"w\": 6, \"x\": 6, \"y\": 8 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"unit\": \"short\",\n          \"thresholds\": {\n            \"mode\": \"absolute\",\n            \"steps\": [{ \"color\": \"blue\", \"value\": null }]\n          }\n        }\n      },\n      \"targets\": [\n        {\n          \"expr\": \"sum(increase(angzarr_command_total[24h]))\",\n          \"legendFormat\": \"Total\",\n          \"refId\": \"A\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Command Latency Heatmap\",\n      \"type\": \"heatmap\",\n      \"gridPos\": { \"h\": 8, \"w\": 12, \"x\": 0, \"y\": 12 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"options\": {\n        \"calculate\": false,\n        \"yAxis\": { \"unit\": \"s\" }\n      },\n      \"targets\": [\n        {\n          \"expr\": \"sum(increase(angzarr_command_duration_bucket[1m])) by (le)\",\n          \"legendFormat\": \"{{le}}\",\n          \"refId\": \"A\",\n          \"format\": \"heatmap\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Commands by Domain\",\n      \"type\": \"piechart\",\n      \"gridPos\": { \"h\": 8, \"w\": 12, \"x\": 12, \"y\": 12 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"targets\": [\n        {\n          \"expr\": \"sum(increase(angzarr_command_total[1h])) by (domain)\",\n          \"legendFormat\": \"{{domain}}\",\n          \"refId\": \"A\"\n        }\n      ]\n    }\n  ],\n  \"schemaVersion\": 39,\n  \"tags\": [\"angzarr\", \"cqrs\", \"commands\"],\n  \"templating\": { \"list\": [] },\n  \"time\": { \"from\": \"now-1h\", \"to\": \"now\" },\n  \"timepicker\": {},\n  \"timezone\": \"browser\",\n  \"title\": \"Angzarr: Command Pipeline\",\n  \"uid\": \"angzarr-commands\",\n  \"version\": 1\n}\n"},"id":"monitoring/angzarr-dashboard-command-pipeline","immutable":false,"metadata":[{"annotations":null,"generate_name":"","generation":0,"labels":{"grafana_dashboard":"1"},"name":"angzarr-dashboard-command-pipeline","namespace":"monitoring","resource_version":"34847","uid":"23440379-3794-4430-b470-aface4509e55"}]},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.observability.helm_release.grafana","module.observability.helm_release.loki","module.observability.helm_release.prometheus","module.observability.helm_release.tempo","module.observability.kubernetes_namespace.monitoring"]},{"index_key":"event-bus.json","schema_version":0,"attributes":{"binary_data":null,"data":{"event-bus.json":"{\n  \"annotations\": { \"list\": [] },\n  \"editable\": true,\n  \"fiscalYearStartMonth\": 0,\n  \"graphTooltip\": 1,\n  \"id\": null,\n  \"links\": [],\n  \"panels\": [\n    {\n      \"title\": \"Bus Publish Throughput (msg/s)\",\n      \"type\": \"timeseries\",\n      \"gridPos\": { \"h\": 8, \"w\": 12, \"x\": 0, \"y\": 0 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"custom\": { \"drawStyle\": \"line\", \"fillOpacity\": 10, \"lineWidth\": 2 },\n          \"unit\": \"ops\"\n        },\n        \"overrides\": []\n      },\n      \"targets\": [\n        {\n          \"expr\": \"sum(rate(angzarr_bus_publish_total[5m])) by (domain, outcome)\",\n          \"legendFormat\": \"{{domain}} ({{outcome}})\",\n          \"refId\": \"A\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Bus Publish Latency p50/p95/p99\",\n      \"type\": \"timeseries\",\n      \"gridPos\": { \"h\": 8, \"w\": 12, \"x\": 12, \"y\": 0 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"custom\": { \"drawStyle\": \"line\", \"fillOpacity\": 5, \"lineWidth\": 2 },\n          \"unit\": \"s\"\n        },\n        \"overrides\": []\n      },\n      \"targets\": [\n        {\n          \"expr\": \"histogram_quantile(0.50, sum(rate(angzarr_bus_publish_duration_bucket[5m])) by (le, domain))\",\n          \"legendFormat\": \"p50 {{domain}}\",\n          \"refId\": \"A\"\n        },\n        {\n          \"expr\": \"histogram_quantile(0.95, sum(rate(angzarr_bus_publish_duration_bucket[5m])) by (le, domain))\",\n          \"legendFormat\": \"p95 {{domain}}\",\n          \"refId\": \"B\"\n        },\n        {\n          \"expr\": \"histogram_quantile(0.99, sum(rate(angzarr_bus_publish_duration_bucket[5m])) by (le, domain))\",\n          \"legendFormat\": \"p99 {{domain}}\",\n          \"refId\": \"C\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Bus Publish Error Rate\",\n      \"type\": \"stat\",\n      \"gridPos\": { \"h\": 4, \"w\": 6, \"x\": 0, \"y\": 8 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"unit\": \"percentunit\",\n          \"thresholds\": {\n            \"mode\": \"absolute\",\n            \"steps\": [\n              { \"color\": \"green\", \"value\": null },\n              { \"color\": \"yellow\", \"value\": 0.01 },\n              { \"color\": \"red\", \"value\": 0.05 }\n            ]\n          }\n        }\n      },\n      \"targets\": [\n        {\n          \"expr\": \"sum(rate(angzarr_bus_publish_total{outcome=\\\"error\\\"}[5m])) / sum(rate(angzarr_bus_publish_total[5m]))\",\n          \"legendFormat\": \"Error Rate\",\n          \"refId\": \"A\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Total Publishes (last 24h)\",\n      \"type\": \"stat\",\n      \"gridPos\": { \"h\": 4, \"w\": 6, \"x\": 6, \"y\": 8 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"unit\": \"short\",\n          \"thresholds\": {\n            \"mode\": \"absolute\",\n            \"steps\": [{ \"color\": \"blue\", \"value\": null }]\n          }\n        }\n      },\n      \"targets\": [\n        {\n          \"expr\": \"sum(increase(angzarr_bus_publish_total[24h]))\",\n          \"legendFormat\": \"Total\",\n          \"refId\": \"A\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Publish Latency by Domain\",\n      \"type\": \"table\",\n      \"gridPos\": { \"h\": 8, \"w\": 24, \"x\": 0, \"y\": 12 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": { \"unit\": \"s\" },\n        \"overrides\": []\n      },\n      \"targets\": [\n        {\n          \"expr\": \"histogram_quantile(0.50, sum(rate(angzarr_bus_publish_duration_bucket[5m])) by (le, domain))\",\n          \"legendFormat\": \"p50\",\n          \"refId\": \"A\",\n          \"format\": \"table\",\n          \"instant\": true\n        },\n        {\n          \"expr\": \"histogram_quantile(0.95, sum(rate(angzarr_bus_publish_duration_bucket[5m])) by (le, domain))\",\n          \"legendFormat\": \"p95\",\n          \"refId\": \"B\",\n          \"format\": \"table\",\n          \"instant\": true\n        },\n        {\n          \"expr\": \"histogram_quantile(0.99, sum(rate(angzarr_bus_publish_duration_bucket[5m])) by (le, domain))\",\n          \"legendFormat\": \"p99\",\n          \"refId\": \"C\",\n          \"format\": \"table\",\n          \"instant\": true\n        }\n      ],\n      \"transformations\": [\n        {\n          \"id\": \"merge\",\n          \"options\": {}\n        }\n      ]\n    }\n  ],\n  \"schemaVersion\": 39,\n  \"tags\": [\"angzarr\", \"event-bus\", \"messaging\"],\n  \"templating\": { \"list\": [] },\n  \"time\": { \"from\": \"now-1h\", \"to\": \"now\" },\n  \"timepicker\": {},\n  \"timezone\": \"browser\",\n  \"title\": \"Angzarr: Event Bus\",\n  \"uid\": \"angzarr-bus\",\n  \"version\": 1\n}\n"},"id":"monitoring/angzarr-dashboard-event-bus","immutable":false,"metadata":[{"annotations":null,"generate_name":"","generation":0,"labels":{"grafana_dashboard":"1"},"name":"angzarr-dashboard-event-bus","namespace":"monitoring","resource_version":"34845","uid":"2d400444-56a6-48ab-9bfa-ae700e758218"}]},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.observability.helm_release.grafana","module.observability.helm_release.loki","module.observability.helm_release.prometheus","module.observability.helm_release.tempo","module.observability.kubernetes_namespace.monitoring"]},{"index_key":"orchestration.json","schema_version":0,"attributes":{"binary_data":null,"data":{"orchestration.json":"{\n  \"annotations\": { \"list\": [] },\n  \"editable\": true,\n  \"fiscalYearStartMonth\": 0,\n  \"graphTooltip\": 1,\n  \"id\": null,\n  \"links\": [],\n  \"panels\": [\n    {\n      \"title\": \"Saga Execution Duration p50/p95/p99\",\n      \"type\": \"timeseries\",\n      \"gridPos\": { \"h\": 8, \"w\": 12, \"x\": 0, \"y\": 0 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"custom\": { \"drawStyle\": \"line\", \"fillOpacity\": 5, \"lineWidth\": 2 },\n          \"unit\": \"s\"\n        },\n        \"overrides\": []\n      },\n      \"targets\": [\n        {\n          \"expr\": \"histogram_quantile(0.50, sum(rate(angzarr_saga_duration_bucket[5m])) by (le))\",\n          \"legendFormat\": \"p50\",\n          \"refId\": \"A\"\n        },\n        {\n          \"expr\": \"histogram_quantile(0.95, sum(rate(angzarr_saga_duration_bucket[5m])) by (le))\",\n          \"legendFormat\": \"p95\",\n          \"refId\": \"B\"\n        },\n        {\n          \"expr\": \"histogram_quantile(0.99, sum(rate(angzarr_saga_duration_bucket[5m])) by (le))\",\n          \"legendFormat\": \"p99\",\n          \"refId\": \"C\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Process Manager Duration p50/p95/p99\",\n      \"type\": \"timeseries\",\n      \"gridPos\": { \"h\": 8, \"w\": 12, \"x\": 12, \"y\": 0 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"custom\": { \"drawStyle\": \"line\", \"fillOpacity\": 5, \"lineWidth\": 2 },\n          \"unit\": \"s\"\n        },\n        \"overrides\": []\n      },\n      \"targets\": [\n        {\n          \"expr\": \"histogram_quantile(0.50, sum(rate(angzarr_pm_duration_bucket[5m])) by (le))\",\n          \"legendFormat\": \"p50\",\n          \"refId\": \"A\"\n        },\n        {\n          \"expr\": \"histogram_quantile(0.95, sum(rate(angzarr_pm_duration_bucket[5m])) by (le))\",\n          \"legendFormat\": \"p95\",\n          \"refId\": \"B\"\n        },\n        {\n          \"expr\": \"histogram_quantile(0.99, sum(rate(angzarr_pm_duration_bucket[5m])) by (le))\",\n          \"legendFormat\": \"p99\",\n          \"refId\": \"C\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Saga Retries (rate/min)\",\n      \"type\": \"timeseries\",\n      \"gridPos\": { \"h\": 8, \"w\": 8, \"x\": 0, \"y\": 8 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"custom\": { \"drawStyle\": \"bars\", \"fillOpacity\": 50, \"lineWidth\": 1 },\n          \"unit\": \"ops\",\n          \"color\": { \"mode\": \"fixed\", \"fixedColor\": \"yellow\" }\n        },\n        \"overrides\": []\n      },\n      \"targets\": [\n        {\n          \"expr\": \"sum(rate(angzarr_saga_retry_total[5m]))\",\n          \"legendFormat\": \"Retries\",\n          \"refId\": \"A\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Saga Compensations (rate/min)\",\n      \"type\": \"timeseries\",\n      \"gridPos\": { \"h\": 8, \"w\": 8, \"x\": 8, \"y\": 8 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"custom\": { \"drawStyle\": \"bars\", \"fillOpacity\": 50, \"lineWidth\": 1 },\n          \"unit\": \"ops\",\n          \"color\": { \"mode\": \"fixed\", \"fixedColor\": \"red\" }\n        },\n        \"overrides\": []\n      },\n      \"targets\": [\n        {\n          \"expr\": \"sum(rate(angzarr_saga_compensation_total[5m]))\",\n          \"legendFormat\": \"Compensations\",\n          \"refId\": \"A\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Projector Duration p50/p95/p99\",\n      \"type\": \"timeseries\",\n      \"gridPos\": { \"h\": 8, \"w\": 8, \"x\": 16, \"y\": 8 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"custom\": { \"drawStyle\": \"line\", \"fillOpacity\": 5, \"lineWidth\": 2 },\n          \"unit\": \"s\"\n        },\n        \"overrides\": []\n      },\n      \"targets\": [\n        {\n          \"expr\": \"histogram_quantile(0.50, sum(rate(angzarr_projector_duration_bucket[5m])) by (le, domain))\",\n          \"legendFormat\": \"p50 {{domain}}\",\n          \"refId\": \"A\"\n        },\n        {\n          \"expr\": \"histogram_quantile(0.95, sum(rate(angzarr_projector_duration_bucket[5m])) by (le, domain))\",\n          \"legendFormat\": \"p95 {{domain}}\",\n          \"refId\": \"B\"\n        },\n        {\n          \"expr\": \"histogram_quantile(0.99, sum(rate(angzarr_projector_duration_bucket[5m])) by (le, domain))\",\n          \"legendFormat\": \"p99 {{domain}}\",\n          \"refId\": \"C\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Saga Retries (24h total)\",\n      \"type\": \"stat\",\n      \"gridPos\": { \"h\": 4, \"w\": 6, \"x\": 0, \"y\": 16 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"unit\": \"short\",\n          \"thresholds\": {\n            \"mode\": \"absolute\",\n            \"steps\": [\n              { \"color\": \"green\", \"value\": null },\n              { \"color\": \"yellow\", \"value\": 10 },\n              { \"color\": \"red\", \"value\": 100 }\n            ]\n          }\n        }\n      },\n      \"targets\": [\n        {\n          \"expr\": \"sum(increase(angzarr_saga_retry_total[24h]))\",\n          \"legendFormat\": \"Retries\",\n          \"refId\": \"A\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Saga Compensations (24h total)\",\n      \"type\": \"stat\",\n      \"gridPos\": { \"h\": 4, \"w\": 6, \"x\": 6, \"y\": 16 },\n      \"datasource\": { \"type\": \"prometheus\", \"uid\": \"prometheus\" },\n      \"fieldConfig\": {\n        \"defaults\": {\n          \"unit\": \"short\",\n          \"thresholds\": {\n            \"mode\": \"absolute\",\n            \"steps\": [\n              { \"color\": \"green\", \"value\": null },\n              { \"color\": \"yellow\", \"value\": 5 },\n              { \"color\": \"red\", \"value\": 50 }\n            ]\n          }\n        }\n      },\n      \"targets\": [\n        {\n          \"expr\": \"sum(increase(angzarr_saga_compensation_total[24h]))\",\n          \"legendFormat\": \"Compensations\",\n          \"refId\": \"A\"\n        }\n      ]\n    }\n  ],\n  \"schemaVersion\": 39,\n  \"tags\": [\"angzarr\", \"saga\", \"process-manager\", \"projector\"],\n  \"templating\": { \"list\": [] },\n  \"time\": { \"from\": \"now-1h\", \"to\": \"now\" },\n  \"timepicker\": {},\n  \"timezone\": \"browser\",\n  \"title\": \"Angzarr: Orchestration\",\n  \"uid\": \"angzarr-orchestration\",\n  \"version\": 1\n}\n"},"id":"monitoring/angzarr-dashboard-orchestration","immutable":false,"metadata":[{"annotations":null,"generate_name":"","generation":0,"labels":{"grafana_dashboard":"1"},"name":"angzarr-dashboard-orchestration","namespace":"monitoring","resource_version":"34846","uid":"bb210960-b8f7-4706-9dfd-5d5288e27248"}]},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.observability.helm_release.grafana","module.observability.helm_release.loki","module.observability.helm_release.prometheus","module.observability.helm_release.tempo","module.observability.kubernetes_namespace.monitoring"]},{"index_key":"topology.json","schema_version":0,"attributes":{"binary_data":null,"data":{"topology.json":"{\n  \"annotations\": { \"list\": [] },\n  \"editable\": true,\n  \"fiscalYearStartMonth\": 0,\n  \"graphTooltip\": 1,\n  \"id\": null,\n  \"links\": [],\n  \"panels\": [\n    {\n      \"title\": \"Runtime Topology\",\n      \"description\": \"Live component graph discovered from event stream. Nodes are aggregates, sagas, process managers, and projectors. Edges represent event/command flows via correlation_id chains.\",\n      \"type\": \"nodeGraph\",\n      \"gridPos\": { \"h\": 20, \"w\": 24, \"x\": 0, \"y\": 0 },\n      \"datasource\": { \"type\": \"hamedkarbasi93-nodegraphapi-datasource\", \"uid\": \"topology\" },\n      \"targets\": [\n        {\n          \"refId\": \"A\"\n        }\n      ],\n      \"fieldConfig\": {\n        \"defaults\": {},\n        \"overrides\": []\n      },\n      \"options\": {}\n    }\n  ],\n  \"schemaVersion\": 39,\n  \"tags\": [\"angzarr\", \"topology\", \"node-graph\"],\n  \"templating\": { \"list\": [] },\n  \"time\": { \"from\": \"now-1h\", \"to\": \"now\" },\n  \"timepicker\": {},\n  \"timezone\": \"browser\",\n  \"title\": \"Angzarr: Topology\",\n  \"uid\": \"angzarr-topology\",\n  \"version\": 1\n}\n"},"id":"monitoring/angzarr-dashboard-topology","immutable":false,"metadata":[{"annotations":null,"generate_name":"","generation":0,"labels":{"grafana_dashboard":"1"},"name":"angzarr-dashboard-topology","namespace":"monitoring","resource_version":"34848","uid":"fb4a8940-30df-439b-b472-14691d7f6df5"}]},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.observability.helm_release.grafana","module.observability.helm_release.loki","module.observability.helm_release.prometheus","module.observability.helm_release.tempo","module.observability.kubernetes_namespace.monitoring"]}]},{"module":"module.observability[0]","mode":"managed","type":"kubernetes_namespace","name":"monitoring","provider":"provider[\"registry.opentofu.org/hashicorp/kubernetes\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"id":"monitoring","metadata":[{"annotations":{},"generate_name":"","generation":0,"labels":{},"name":"monitoring","resource_version":"466","uid":"454c427e-8542-47ed-9091-04743454dfb1"}],"timeouts":null,"wait_for_default_service_account":false},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiZGVsZXRlIjozMDAwMDAwMDAwMDB9fQ=="}]}],"check_results":[{"object_kind":"var","config_addr":"module.mesh.var.type","status":"pass","objects":null}]}
