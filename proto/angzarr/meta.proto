syntax = "proto3";
package angzarr;
option go_package = "github.com/angzarr/angzarr/proto/angzarr";
option java_package = "dev.angzarr";
option java_multiple_files = true;
option csharp_namespace = "Angzarr";
option ruby_package = "Angzarr";

import "angzarr/types.proto";
import "google/protobuf/timestamp.proto";

// ============================================================================
// Meta Domain (_angzarr) - Infrastructure commands/events
// ============================================================================

// Command to register a component in the topology registry.
// Root UUID is derived from descriptor.name for idempotent registration.
message RegisterComponent {
  ComponentDescriptor descriptor = 1;
  string pod_id = 2;  // K8s pod name or hostname for standalone
}

// Event emitted when a component registers or re-registers.
message ComponentRegistered {
  ComponentDescriptor descriptor = 1;
  string pod_id = 2;
  google.protobuf.Timestamp registered_at = 3;
}

// Delete all events for an edition+domain combination.
// Main timeline ('angzarr' or empty edition name) cannot be deleted.
message DeleteEditionEvents {
  string edition = 1;   // Edition name to delete from
  string domain = 2;    // Domain to delete from
}

// Response from edition event deletion.
message EditionEventsDeleted {
  string edition = 1;
  string domain = 2;
  uint32 deleted_count = 3;
  string deleted_at = 4;
}
